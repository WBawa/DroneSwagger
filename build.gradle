import org.openapitools.generator.gradle.plugin.tasks.GenerateTask
// Top-level build file where you can add configuration options common to all sub-projects/modules.
plugins {
    id 'com.android.application' version '7.3.1' apply false
    id 'com.android.library' version '7.3.1' apply false
    id 'org.jetbrains.kotlin.android' version '1.7.20' apply false
    id "org.openapi.generator" version "6.3.0"
}

task generateApi(type: GenerateTask) {
    generatorName = "kotlin"
    inputSpec = "$rootDir/swagger.yaml".toString()
    outputDir = "$buildDir/api-spec/generated".toString()
    apiPackage = "com.riis.droneswagger.api.common"
    invokerPackage = "com.riis.droneswagger.generated.api.invoker.common"
    modelPackage = "com.riis.droneswagger.generated.api.model.common"
    configOptions = [dateLibrary: "java8", useRxJava3:"true", serializationLibrary: "gson"]
//    configOptions = [dateLibrary: "java8", serializationLibrary: "gson"]
}

task copyApiFilesIntoProject(type: Copy) {
    dependsOn(generateApi)
    from "$buildDir/api-spec/generated/src/main/kotlin/".toString()
    into "$rootDir/app/src/main/java/".toString()
}